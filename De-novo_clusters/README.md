# De-novo clusters

Analysis to visualise genome-wide LTR and total transposon content, respectively, to aid the discovery of unistrand piRNA clusters. To produce the output files, run the following scripts:

```
. 01_prepare.sh
```
*Step 1:* Create an output folder at a chosen location and make a link to it called `scratch`. All results of the subsequent steps will be written to `scratch`.

```
. 02_fix_headers.sh
```
*Step 2:* Restore the full contig names to `EDTA/genome.fa.mod.EDTA.anno/genome.fa.mod.out`, since EDTA will cap them at a fixed number of characters.

```
. 03_tab.sh
```
*Step 3:* Convert the .out file generated by RepeatMasker (run by EDTA) to a tab-separated format.

```
. 04_bed.sh
```
*Step 4:* Convert the tab-separated format to bed format, exclude transposons of type Unknown, and use bedtools merge to combine overlapping bed regions. This step uses `toBed6-10.pl` which can be retrieved from [http://genomewiki.ucsc.edu/index.php/RepeatMasker](http://genomewiki.ucsc.edu/index.php/RepeatMasker).

```
. 05_bins.sh
```
*Step 5:* Create 100kb sliding windows (5kb overlap) and calculate transposon coverage per bin.

```
. 06_bed_LTR-only.sh
```
*Step 6:* Same as step 4, but including only LTR transposons.

```
. 07_bins_LTR-only.sh
```
*Step 7:* Same as step 5, but including only LTR transposons.

## Output

The output is produced in the form of a tab-separated file representing
1. Chromosome
2. Start coordinate
3. End coordinate
4. Number of overlapping bed intervals
5. Length of bin (usually 100000)
6. Transposon coverage (within 0..1)

Example output:
```
$ head scratch/05_bins/overlap/plus/Dmel.dm6.bed 
chr2L	0	100000	7	5783	100000	0.0578300
chr2L	5000	105000	7	5783	100000	0.0578300
chr2L	10000	110000	7	5783	100000	0.0578300
chr2L	15000	115000	7	5783	100000	0.0578300
chr2L	20000	120000	8	6321	100000	0.0632100
chr2L	25000	125000	6	6170	100000	0.0617000
chr2L	30000	130000	6	6170	100000	0.0617000
chr2L	35000	135000	6	6170	100000	0.0617000
chr2L	40000	140000	7	6237	100000	0.0623700
chr2L	45000	145000	7	6237	100000	0.0623700
$ head scratch/05_bins/overlap/minus/Dmel.dm6.bed 
chr2L	0	100000	5	547	100000	0.0054700
chr2L	5000	105000	5	547	100000	0.0054700
chr2L	10000	110000	4	469	100000	0.0046900
chr2L	15000	115000	4	469	100000	0.0046900
chr2L	20000	120000	5	558	100000	0.0055800
chr2L	25000	125000	4	477	100000	0.0047700
chr2L	30000	130000	3	421	100000	0.0042100
chr2L	35000	135000	3	421	100000	0.0042100
chr2L	40000	140000	3	421	100000	0.0042100
chr2L	45000	145000	3	421	100000	0.0042100
```
